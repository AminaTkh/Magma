# Magma

Реализация шифра Магма

Описание:
http://wwwold.tc26.ru/standard/gost/GOST_R_3412-2015.pdf
http://wwwold.tc26.ru/standard/gost/GOST_R_3413-2015.pdf

В данном задании требуется написать реализацию шифра Магма ГОСТ Р 34.12-2015 п.5 с режимами работы согласно ГОСТ Р 34.13-2015.
Необходимо использовать процедуру дополнения исходных данных ГОСТ Р 34.13-2015 п. 4.1.2 для режимов ECB, CBC и CFB (п.5.1, 5.4, 5.5), ГОСТ Р 34.13-2015 п. 4.1.3 для режима MAC (п.5.6).
Поведение программы должно полностью управляться аргументами командной строки, в связи с чем  потребуется реализовать полноценную обработку передаваемых параметров.

Описание флагов:

magma [-h|--help]
magma [--ecb|--ctr|--ofb|--cbc|--cfb] {-e|-d} -k <key file> [options]
magma --mac -k <key file> [options]

• -h | --help – вывести описание флагов в stdout.
• режимы работы, по умолчанию используется режим ECB:
--ecb – ГОСТ Р 34.13-2015, 
--ctr – ГОСТ Р 34.13-2015, 
--ofb – ГОСТ Р 34.13-2015, 
--cbc – ГОСТ Р 34.13-2015, 
--cfb – ГОСТ Р 34.13-2015, 
--mac – ГОСТ Р 34.13-2015,
• -e – зашифрование 
• -d – дешифрование
• -k <key file> – файл с бинарным ключом. 
• [options]:
-i <input file> – входной файл. По умолчанию читать с stdin до EOF;
-o <output file> – выходной файл. По умолчанию выводить в stdout;
-v <iv file> – файл с бинарным значением IV. Используется с режимами CTR (32 бита), OFB, CBC, CFB (64z бита, z ∈ N). По умолчанию IV=0 минимально допустимой длины.

Примеры использования:
magma --mac -k file.key -i file.in -o file.out
magma --ctr -e -i path/to/file/to/ecrypt -o path/to/encrypted/file 
-k path/to/key/file -v path/to/iv/file
